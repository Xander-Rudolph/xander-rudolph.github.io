<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>PowerShell Packages - Caution</title>
    <link rel="stylesheet" href="/assets/built/screen.css?v=3edc33f899">

    <link rel="canonical" href="https://xander-rudolph.github.io/powershell-packages/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    
    <meta property="og:site_name" content="Xander&#x27;s Lander" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="PowerShell Packages - Caution" />
    <meta property="og:description" content="NOTE: This post gets a little into the weeds on powershell and can break things if not done correctly. When working with PowerShellGet and PackageManagement, things can get a little weird because they have been around for ages and have pretty Frankenstein fixes to support legacy.


PowerShellGet and PackageManagement

First" />
    <meta property="og:url" content="https://xander-rudolph.github.io/powershell-packages/" />
    <meta property="og:image" content="https://xander-rudolph.github.io/content/images/2023/04/00002-174996995-2.png" />
    <meta property="article:published_time" content="2023-04-29T13:21:06.000Z" />
    <meta property="article:modified_time" content="2023-04-29T13:21:06.000Z" />
    <meta property="article:tag" content="PowerShell" />
    
    <meta property="article:publisher" content="https://www.facebook.com/Jewtus" />
    <meta property="article:author" content="https://www.facebook.com/Jewtus" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="PowerShell Packages - Caution" />
    <meta name="twitter:description" content="NOTE: This post gets a little into the weeds on powershell and can break things if not done correctly. When working with PowerShellGet and PackageManagement, things can get a little weird because they have been around for ages and have pretty Frankenstein fixes to support legacy.


PowerShellGet and PackageManagement

First" />
    <meta name="twitter:url" content="https://xander-rudolph.github.io/powershell-packages/" />
    <meta name="twitter:image" content="https://xander-rudolph.github.io/content/images/2023/04/00002-174996995-2.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Alex Rudolph" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="PowerShell" />
    <meta name="twitter:site" content="@Jewtus" />
    <meta name="twitter:creator" content="@Jewtus" />
    <meta property="og:image:width" content="1920" />
    <meta property="og:image:height" content="1080" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Xander&#x27;s Lander",
        "url": "https://xander-rudolph.github.io/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://xander-rudolph.github.io/favicon.ico",
            "width": 48,
            "height": 48
        }
    },
    "author": {
        "@type": "Person",
        "name": "Alex Rudolph",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/0e0bdb5543f553f85e652ff1230673d4?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "https://xander-rudolph.github.io/author/alex/",
        "sameAs": [
            "http://xanderu.duckdns.org/",
            "https://www.facebook.com/Jewtus",
            "https://twitter.com/Jewtus"
        ]
    },
    "headline": "PowerShell Packages - Caution",
    "url": "https://xander-rudolph.github.io/powershell-packages/",
    "datePublished": "2023-04-29T13:21:06.000Z",
    "dateModified": "2023-04-29T13:21:06.000Z",
    "keywords": "PowerShell",
    "description": "NOTE: This post gets a little into the weeds on powershell and can break things if not done correctly. When working with PowerShellGet and PackageManagement, things can get a little weird because they have been around for ages and have pretty Frankenstein fixes to support legacy.\n\n\nPowerShellGet and PackageManagement\n\nFirst we are going to cover the two fundamental modules that run most module/package stuff in PowerShell. PackageManagement and PowerShellGet work hand in hand with each other. Whe",
    "mainEntityOfPage": "https://xander-rudolph.github.io/powershell-packages/"
}
    </script>

    <meta name="generator" content="Ghost 5.45" />
    <link rel="alternate" type="application/rss+xml" title="Xander&#x27;s Lander" href="https://xander-rudolph.github.io/rss/" />
    <script defer src="https://cdn.jsdelivr.net/ghost/portal@~2.29/umd/portal.min.js" data-i18n="false" data-ghost="https://xander-rudolph.github.io/" data-key="3c970d365f1c360a8a0aab9b3a" data-api="https://xander-rudolph.github.io/ghost/api/content/" crossorigin="anonymous"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
    <script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/sodo-search.min.js" data-key="3c970d365f1c360a8a0aab9b3a" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/main.css" data-sodo-search="https://xander-rudolph.github.io/" crossorigin="anonymous"></script>
    
    <link href="https://xander-rudolph.github.io/webmentions/receive/" rel="webmention" />
    <script defer src="/public/cards.min.js?v=3edc33f899"></script>
    <link rel="stylesheet" type="text/css" href="/public/cards.min.css?v=3edc33f899">
    <script defer src="/public/member-attribution.min.js?v=3edc33f899"></script>
    <style type='text/css'>
    .gh-head-link,
	.gh-head-button, 
    .gh-head-members,
    section.footer-cta { display: none; }
</style><style>:root {--ghost-accent-color: #d60000;}</style>
</head>

<body class="post-template tag-powershell  is-head-left-logo">
<div class="site">

    <header id="gh-head" class="gh-head gh-outer">
        <div class="gh-head-inner gh-inner">
            <div class="gh-head-brand">
                <div class="gh-head-brand-wrapper">
                    <a class="gh-head-logo" href="https://xander-rudolph.github.io">
                            Xander&#x27;s Lander
                    </a>
                </div>
                <button class="gh-search gh-icon-btn" aria-label="Search this site" data-ghost-search><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M17.5 17.5L12.5 12.5L17.5 17.5ZM14.1667 8.33333C14.1667 9.09938 14.0158 9.85792 13.7226 10.5657C13.4295 11.2734 12.9998 11.9164 12.4581 12.4581C11.9164 12.9998 11.2734 13.4295 10.5657 13.7226C9.85792 14.0158 9.09938 14.1667 8.33333 14.1667C7.56729 14.1667 6.80875 14.0158 6.10101 13.7226C5.39328 13.4295 4.75022 12.9998 4.20854 12.4581C3.66687 11.9164 3.23719 11.2734 2.94404 10.5657C2.65088 9.85792 2.5 9.09938 2.5 8.33333C2.5 6.78624 3.11458 5.30251 4.20854 4.20854C5.30251 3.11458 6.78624 2.5 8.33333 2.5C9.88043 2.5 11.3642 3.11458 12.4581 4.20854C13.5521 5.30251 14.1667 6.78624 14.1667 8.33333Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</button>
                <button class="gh-burger"></button>
            </div>

            <nav class="gh-head-menu">
                <ul class="nav">
    <li class="nav-home"><a href="https://xander-rudolph.github.io/">Home</a></li>
    <li class="nav-about"><a href="https://xander-rudolph.github.io/about/">About</a></li>
    <li class="nav-resume"><a href="https://xander-rudolph.github.io/online-cv/">Resume</a></li>
</ul>

            </nav>

            <div class="gh-head-actions">
                    <button class="gh-search gh-icon-btn" aria-label="Search this site" data-ghost-search><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M17.5 17.5L12.5 12.5L17.5 17.5ZM14.1667 8.33333C14.1667 9.09938 14.0158 9.85792 13.7226 10.5657C13.4295 11.2734 12.9998 11.9164 12.4581 12.4581C11.9164 12.9998 11.2734 13.4295 10.5657 13.7226C9.85792 14.0158 9.09938 14.1667 8.33333 14.1667C7.56729 14.1667 6.80875 14.0158 6.10101 13.7226C5.39328 13.4295 4.75022 12.9998 4.20854 12.4581C3.66687 11.9164 3.23719 11.2734 2.94404 10.5657C2.65088 9.85792 2.5 9.09938 2.5 8.33333C2.5 6.78624 3.11458 5.30251 4.20854 4.20854C5.30251 3.11458 6.78624 2.5 8.33333 2.5C9.88043 2.5 11.3642 3.11458 12.4581 4.20854C13.5521 5.30251 14.1667 6.78624 14.1667 8.33333Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</button>
                    <div class="gh-head-members">
                                <a class="gh-head-link" href="#/portal/signin" data-portal="signin">Sign in</a>
                                <a class="gh-head-btn gh-btn gh-primary-btn" href="#/portal/signup" data-portal="signup">Subscribe</a>
                    </div>
            </div>
        </div>
    </header>


    <div class="site-content">
        
<main class="site-main">


    <article class="post tag-powershell no-image">

        <header class="gh-article-header gh-canvas">
            <h1 class="gh-article-title">PowerShell Packages - Caution</h1>
            <div class="post-meta">
                Last updated on&nbsp;
                <time datetime="2023-04-29">Apr 29, 2023</time>
            </div>
                    </header>

        <div class="gh-content gh-canvas">
            <!--kg-card-begin: html--><b style="color:red;">NOTE: This post gets a little into the weeds on powershell and can break things if not done correctly. When working with PowerShellGet and PackageManagement, things can get a little weird because they have been around for ages and have pretty Frankenstein fixes to support legacy.</b><!--kg-card-end: html--><h2 id="powershellget-and-packagemanagement">PowerShellGet and PackageManagement</h2><p>First we are going to cover the two fundamental modules that run most module/package stuff in PowerShell. PackageManagement and PowerShellGet work hand in hand with each other. When you run Install-module for PackageManagement you will generally get a failure because you are currently using PackageManagement because PowerShellGet is using it to run Install-Module (meta... I know). There are dozens of tutorials that explain this in more detail so I won't get in to the specifics, just recommend the following command:</p><!--kg-card-begin: markdown--><pre><code class="language-shell">powershell.exe -NoLogo -NoProfile -Command '[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; Install-Module -Name PackageManagement -Force -MinimumVersion 1.4.6 -Scope AllUsers -AllowClobber -Repository PSGallery'
</code></pre>
<!--kg-card-end: markdown--><p>This will run the install command in a new session and should upgrade your PackageManagement.</p><h2 id="what-just-happened">What just happened?</h2><p>The script above is actually doing something quite simple. Windows will store packages in the <code>%programfiles%\WindowsPowerShell</code> directory. This is the <strong>GLOBAL</strong> location for modules. When you run powershell as an admin, this is where modules go. When you are not running as an admin, it will generally use <code>%userprofile%\Documents\WindowsPowerShell</code>. These settings can be tweaked/overridden using <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-7.1&ref=localhost" rel="noreferrer noopener">profile scripts</a>. If you navigate to the WindowsPowerShell directory you will find a modules folder, which will have a PackageManagment folder. In that folder you will see the different versions that you have installed. Additionally you can use the following command to see what powershell is loading from <code>$ENV:PSMODULEPATH</code>:<br><code>Get-InstalledModule</code></p><h2 id="module-and-script-construction">Module and script construction</h2><p>I have put together a simple module that uses some simple PowerShell functions to build templates for scripts and modules. Run the following commands:<br><code>install-module xanderu.helpers </code><br><code>New-PowershellTemplate</code></p><p>This will automatically create a module or script based on the input prompts. If you haven't specified a directory, it will use the current directory to create the structure.</p><h2 id="loading-and-debugging-modules">Loading and debugging modules</h2><p>Without a pipeline, loading and debugging modules is actually quite simple. By copying the module into the <code>%programfiles%\WindowsPowerShell</code> directory it will auto load when you open powershell. This can cause issues when debugging as it can get confusing when you are trying to make changes. You will not be sure what version of the modules functions you are using. Instead, when debugging use:<br><code>Import-Module -force -allowclobber .\Path\to\module.psm1</code></p><p>This will allow you to specify exactly what module you want to load. It will automatically override and replace any functions you have in your current session.</p>
        </div>

        <div class="pagination-container gh-canvas">
        <nav class="pagination">

            <div class="pagination-left">
                    <a class="newer-posts" href="/just-some-helpful-powershell/">
                        <span class="pagination-label">Previous</span>
                        Just some helpful PowerShell
                    </a>
            </div>

            <div class="pagination-right">
            </div>

        </nav>
        </div>


    </article>


</main>
    </div>

    <footer class="gh-foot gh-outer">
        <div class="gh-foot-inner gh-inner">
            <div class="gh-copyright">
                Xander&#x27;s Lander © 2023
            </div>
            <nav class="gh-foot-menu">
                <ul class="nav">
    <li class="nav-sign-in"><a href="https://xander-rudolph.github.io/ghost/#/dashboard/">Sign in</a></li>
    <li class="nav-media"><a href="http://xanderu.duckdns.org:81/">Media</a></li>
    <li class="nav-requests"><a href="http://xanderu.duckdns.org:83/ombi">Requests</a></li>
</ul>

            </nav>
            <div class="gh-powered-by">
                <a href="https://ghost.org/" target="_blank" rel="noopener">Powered by Ghost</a>
            </div>
        </div>
    </footer>

</div>

    <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="pswp__bg"></div>

    <div class="pswp__scroll-wrap">
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>
<script
    src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous">
</script>
<script src="/assets/built/main.min.js?v=3edc33f899"></script>



</body>
</html>