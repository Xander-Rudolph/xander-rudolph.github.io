<!DOCTYPE html>
<html lang="en" class="dark-mode">
<head>

    <title>Just some helpful PowerShell</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css?v=49a7db16b7" />

    <link rel="canonical" href="https://xander-rudolph.github.io/just-some-helpful-powershell/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    
    <meta property="og:site_name" content="Xander&#x27;s Lander" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Just some helpful PowerShell" />
    <meta property="og:description" content="Where to start with powershell

I&#x27;ve build a helper function that anyone can use to get a simple pipeline off the ground and have it prepped and ready for use in Azure Devops. The module can also be found in the PSGallery.

I have not done very robust documentation on" />
    <meta property="og:url" content="https://xander-rudolph.github.io/just-some-helpful-powershell/" />
    <meta property="og:image" content="https://xander-rudolph.github.io/content/images/2023/04/00002-174996995-2.png" />
    <meta property="article:published_time" content="2023-04-29T13:12:58.000Z" />
    <meta property="article:modified_time" content="2023-04-29T13:12:58.000Z" />
    <meta property="article:publisher" content="https://www.facebook.com/Jewtus" />
    <meta property="article:author" content="https://www.facebook.com/Jewtus" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Just some helpful PowerShell" />
    <meta name="twitter:description" content="Where to start with powershell

I&#x27;ve build a helper function that anyone can use to get a simple pipeline off the ground and have it prepped and ready for use in Azure Devops. The module can also be found in the PSGallery.

I have not done very robust documentation on" />
    <meta name="twitter:url" content="https://xander-rudolph.github.io/just-some-helpful-powershell/" />
    <meta name="twitter:image" content="https://xander-rudolph.github.io/content/images/2023/04/00002-174996995-2.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Alex Rudolph" />
    <meta name="twitter:site" content="@Jewtus" />
    <meta name="twitter:creator" content="@Jewtus" />
    <meta property="og:image:width" content="1920" />
    <meta property="og:image:height" content="1080" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Xander&#x27;s Lander",
        "url": "https://xander-rudolph.github.io/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://xander-rudolph.github.io/favicon.ico",
            "width": 48,
            "height": 48
        }
    },
    "author": {
        "@type": "Person",
        "name": "Alex Rudolph",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/0e0bdb5543f553f85e652ff1230673d4?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "https://xander-rudolph.github.io/author/alex/",
        "sameAs": [
            "http://xanderu.duckdns.org/",
            "https://www.facebook.com/Jewtus",
            "https://twitter.com/Jewtus"
        ]
    },
    "headline": "Just some helpful PowerShell",
    "url": "https://xander-rudolph.github.io/just-some-helpful-powershell/",
    "datePublished": "2023-04-29T13:12:58.000Z",
    "dateModified": "2023-04-29T13:12:58.000Z",
    "description": "Where to start with powershell\n\nI&#x27;ve build a helper function that anyone can use to get a simple pipeline off the ground and have it prepped and ready for use in Azure Devops. The module can also be found in the PSGallery.\n\nI have not done very robust documentation on this pipeline because its all pretty generic. When working with powershell there are many standards that can, but do not need to be, applied to script or module files but they aren&#x27;t required. The module above is simply a template ",
    "mainEntityOfPage": "https://xander-rudolph.github.io/just-some-helpful-powershell/"
}
    </script>

    <meta name="generator" content="Ghost 5.45" />
    <link rel="alternate" type="application/rss+xml" title="Xander&#x27;s Lander" href="https://xander-rudolph.github.io/rss/" />
    <script defer src="https://cdn.jsdelivr.net/ghost/portal@~2.29/umd/portal.min.js" data-i18n="false" data-ghost="https://xander-rudolph.github.io/" data-key="3c970d365f1c360a8a0aab9b3a" data-api="https://xander-rudolph.github.io/ghost/api/content/" crossorigin="anonymous"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
    <script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/sodo-search.min.js" data-key="3c970d365f1c360a8a0aab9b3a" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/main.css" data-sodo-search="https://xander-rudolph.github.io/" crossorigin="anonymous"></script>
    
    <link href="https://xander-rudolph.github.io/webmentions/receive/" rel="webmention" />
    <script defer src="/public/cards.min.js?v=49a7db16b7"></script>
    <link rel="stylesheet" type="text/css" href="/public/cards.min.css?v=49a7db16b7">
    <script defer src="/public/member-attribution.min.js?v=49a7db16b7"></script>
    <style type='text/css'>
    .gh-head-link,
	.gh-head-button, 
    section.footer-cta { display: none; }
</style><style>:root {--ghost-accent-color: #d60000;}</style>

</head>
<body class="post-template is-head-middle-logo has-sans-body has-cover">
<div class="viewport">

    <header id="gh-head" class="gh-head outer">
        <div class="gh-head-inner inner">
            <div class="gh-head-brand">
                <a class="gh-head-logo no-image" href="https://xander-rudolph.github.io">
                        Xander&#x27;s Lander
                </a>
                <button class="gh-search gh-icon-btn" aria-label="Search this site" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
                <button class="gh-burger"></button>
            </div>

            <nav class="gh-head-menu">
                <ul class="nav">
    <li class="nav-home"><a href="https://xander-rudolph.github.io/">Home</a></li>
    <li class="nav-about"><a href="https://xander-rudolph.github.io/about/">About</a></li>
    <li class="nav-resume"><a href="https://xander-rudolph.github.io/online-cv/">Resume</a></li>
</ul>

            </nav>

            <div class="gh-head-actions">
                    <button class="gh-search gh-icon-btn" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
                    <div class="gh-head-members">
                                <a class="gh-head-link" href="#/portal/signin" data-portal="signin">Sign in</a>
                                <a class="gh-head-button" href="#/portal/signup" data-portal="signup">Subscribe</a>
                    </div>
            </div>
        </div>
    </header>

    <div class="site-content">
        



<main id="site-main" class="site-main">
<article class="article post no-image ">

    <header class="article-header gh-canvas">

        <div class="article-tag post-card-tags">
        </div>

        <h1 class="article-title">Just some helpful PowerShell</h1>


        <div class="article-byline">
        <section class="article-byline-content">

            <ul class="author-list">
                <li class="author-list-item">
                    <a href="/author/alex/" class="author-avatar">
                        <img class="author-profile-image" src="//www.gravatar.com/avatar/0e0bdb5543f553f85e652ff1230673d4?s&#x3D;250&amp;d&#x3D;mm&amp;r&#x3D;x" alt="Alex Rudolph" />
                    </a>
                </li>
            </ul>

            <div class="article-byline-meta">
                <h4 class="author-name"><a href="/author/alex/">Alex Rudolph</a></h4>
                <div class="byline-meta-content">
                    <time class="byline-meta-date" datetime="2023-04-29">Apr 29, 2023</time>
                        <span class="byline-reading-time"><span class="bull">&bull;</span> 3 min read</span>
                </div>
            </div>

        </section>
        </div>


    </header>

    <section class="gh-content gh-canvas">
        <!--kg-card-begin: html--><h2>Where to start with powershell</h2><!--kg-card-end: html--><p>I've build a helper function that anyone can use to get a simple pipeline off the ground and have it prepped and ready for use in Azure Devops. The module can also be found in the <a href="https://www.powershellgallery.com/packages/xanderu.helpers?ref=localhost" rel="noreferrer noopener">PSGallery</a>.</p><p>I have not done very robust documentation on this pipeline because its all pretty generic. When working with powershell there are many standards that can, but do not need to be, applied to script or module files but they aren't required. The module above is simply a template that will stamp out the file/folder stucture that is needed for publishing a module with each function broken down for easy of use and portability.</p><!--kg-card-begin: html--><h2>Where you run matters</h2><!--kg-card-end: html--><p>When using powershell, the context in which you start powershell changes how it operates. This can be seen most obviously with a simple powershell builtin called $PSVersionTable:</p><figure class="kg-card kg-image-card"><img src="https://xander-rudolph.github.io/content/images/2023/04/image2021-2-19_6-46-10.png" class="kg-image" alt loading="lazy" width="395" height="177"></figure><p>PSVersiontable will print out the version of powershell you are running. If you have multiple versions of powershell installed, you may need to switch the context. With VS Code, you can use CTRL+SHIFT+P and then type "Session" to change the version of powershell in the terminal:</p><figure class="kg-card kg-image-card"><img src="https://xander-rudolph.github.io/content/images/2023/04/image2021-2-19_6-49-54.png" class="kg-image" alt loading="lazy" width="623" height="82" srcset="https://xander-rudolph.github.io/content/images/size/w600/2023/04/image2021-2-19_6-49-54.png 600w, https://xander-rudolph.github.io/content/images/2023/04/image2021-2-19_6-49-54.png 623w"></figure><p>If you look at the VS Code <code>settings.json</code> (the default path is <code>%appdata%\Code\User\settings.json</code>) you can see what default PowerShell is being used: <br>"powershell.powerShellDefaultVersion": "Windows PowerShell (x64)" </p><p>It's important to know what context you are running in because some things may or may not work because of localized settings. Managing how and where you run your code has a big impact on how errors will present themselves and what will be supported.</p><!--kg-card-begin: html--><h2>Installing core</h2><!--kg-card-end: html--><p>The screenshot above is what generally will show up on your windows machine if you use PowerShell on a windows host. PowerShell started to diverge in v6 (AKA PowerShell core) and doesn't natively come on any OS. </p><p>For Windows:<br><code>winget install --id Microsoft.Powershell --source winget</code><br>For Mac:<br><code>brew install powershell</code><br>For Linux:<br><code>snap install powershell --classic</code></p><h2 id="what-gives-with-the-versions"><strong>What gives with the versions?</strong></h2><p>PowerShell has been around for a long time in the windows space, however PowerShell 6 and up are cross platform. There are limiting factors to writing cross platform scripts, namely related to .net libraries. A script that is designed for PowerShell 5.1 (windows) is likely only going to work on windows because of the various .net frameworks that come prepackaged on windows installations. For example, if a PowerShell script is using pop up forms (windows forms in .net) it won't work on a Linux or Mac because the Windows forms libraries are not available. Some libraries have also become cross platform and can be found in .net core (versions can change what options you will have available).</p><h2 id="what-does-that-look-like">What does that look like?</h2><p>When using cross platform modules, you can make things look and act differently depending on the OS or context in which it's called. For example, the <code>Get-Credential</code> function when called from a windows PowerShell terminal will give a pop up:</p><figure class="kg-card kg-image-card"><img src="https://xander-rudolph.github.io/content/images/2023/04/image2021-2-19_7-12-54.png" class="kg-image" alt loading="lazy" width="321" height="259"></figure><p>And when you use a PowerShell session in PS core on the same machine you will get a command line prompt:</p><figure class="kg-card kg-image-card"><img src="https://xander-rudolph.github.io/content/images/2023/04/image2021-2-19_7-12-40.png" class="kg-image" alt loading="lazy" width="380" height="100"></figure><h2 id="in-summary">In Summary</h2><p>When working with PowerShell it's important to understand how and where you are planning to run your scripts. The way PowerShell operates is going to be different based on the version, the context, and the features you have installed on your local machine. Where possible, it is best to include any required DLLs/EXE files you might need and use relative pathing to make your scripts more portable/packable. This can sometimes bloat the size of your code base, but if you don't include it, a check in the script/module to make sure all dependencies are met is a good idea. This can be done with <code>#requires</code> or <code>.MODULESREQUIRED</code> or by writing up explicit checks in the source to throw tailored errors.</p>
    </section>


</article>
</main>

    <section class="footer-cta outer">
        <div class="inner">
            
            <a class="footer-cta-button" href="#/portal" data-portal>
                <div class="footer-cta-input">Enter your email</div>
                <span>Subscribe</span>
            </a>
        </div>
    </section>




    </div>

    <footer class="site-footer outer">
        <div class="inner">
            <section class="copyright"><a href="https://xander-rudolph.github.io">Xander&#x27;s Lander</a> &copy; 2023</section>
            <nav class="site-footer-nav">
                <ul class="nav">
    <li class="nav-sign-in"><a href="https://xander-rudolph.github.io/ghost/#/dashboard/">Sign in</a></li>
    <li class="nav-media"><a href="http://xanderu.duckdns.org:81/">Media</a></li>
    <li class="nav-requests"><a href="http://xanderu.duckdns.org:83/ombi">Requests</a></li>
</ul>

            </nav>
            <div class="gh-powered-by"><a href="https://ghost.org/" target="_blank" rel="noopener">Powered by Ghost</a></div>
        </div>
    </footer>

</div>


<script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous">
</script>
<script src="/assets/built/casper.js?v=49a7db16b7"></script>
<script>
$(document).ready(function () {
    // Mobile Menu Trigger
    $('.gh-burger').click(function () {
        $('body').toggleClass('gh-head-open');
    });
    // FitVids - Makes video embeds responsive
    $(".gh-content").fitVids();
});
</script>



</body>
</html>
